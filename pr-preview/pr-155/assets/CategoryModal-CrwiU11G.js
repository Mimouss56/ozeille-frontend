import{r as f,R as t,j as l}from"./iframe-CC6WGNqu.js";import{o as M,s as v,u as F}from"./schemas-CTJF-20V.js";import{n as S}from"./coerce-ZQTUorlt.js";import{u as P}from"./budgetsStore-DoavkucW.js";import{I as W}from"./InputField-CdiIKe8A.js";import{M as N}from"./Modal-Bi7mzgj7.js";import{S as Z}from"./Select-BrkO88BN.js";var _=f.createContext({color:"currentColor",size:"1em",weight:"regular",mirrored:!1}),z=function(a,s,o){var n=o.get(a);return n?n(s):(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),null)};function w(e,a){if(e==null)return{};var s={},o=Object.keys(e),n,d;for(d=0;d<o.length;d++)n=o[d],!(a.indexOf(n)>=0)&&(s[n]=e[n]);return s}var A=f.forwardRef(function(e,a){var s=e.alt,o=e.color,n=e.size,d=e.weight,E=e.mirrored,c=e.children,x=e.renderPath,m=w(e,["alt","color","size","weight","mirrored","children","renderPath"]),u=f.useContext(_),k=u.color,L=k===void 0?"currentColor":k,b=u.size,r=u.weight,h=r===void 0?"regular":r,i=u.mirrored,g=i===void 0?!1:i,j=w(u,["color","size","weight","mirrored"]);return t.createElement("svg",Object.assign({ref:a,xmlns:"http://www.w3.org/2000/svg",width:n??b,height:n??b,fill:o??L,viewBox:"0 0 256 256",transform:E||g?"scale(-1, 1)":void 0},j,m),!!s&&t.createElement("title",null,s),c,t.createElement("rect",{width:"256",height:"256",fill:"none"}),x(d??h,o??L))});A.displayName="IconBase";var p=new Map;p.set("bold",function(e){return t.createElement(t.Fragment,null,t.createElement("line",{x1:"44",y1:"156",x2:"100",y2:"212",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.createElement("line",{x1:"164",y1:"92",x2:"72",y2:"184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});p.set("duotone",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M192,120,136,64l26.3-26.3a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4Z",opacity:"0.2"}),t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});p.set("fill",function(){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,76.7,179.3,32a15.9,15.9,0,0,0-22.6,0L130.3,58.3h0L36.7,152A15.9,15.9,0,0,0,32,163.3V208a16,16,0,0,0,16,16H92.7a15.9,15.9,0,0,0,11.3-4.7l120-120A16.1,16.1,0,0,0,224,76.7ZM51.3,160,144,67.3,160.7,84,68,176.7ZM48,179.3,76.7,208H48Zm48,25.4L79.3,188,172,95.3,188.7,112Z"}))});p.set("light",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});p.set("thin",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});p.set("regular",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var B=function(a,s){return z(a,s,p)},I=f.forwardRef(function(e,a){return t.createElement(A,Object.assign({ref:a},e,{renderPath:B}))});I.displayName="Pencil";const H=M({label:v().min(1,"Le label est requis"),limitAmount:S({invalid_type_error:"Le montant doit être un nombre"}).optional(),budgetId:v().min(1,"Veuillez sélectionner un budget"),color:v().optional()}),y={label:"",budgetId:"",color:"#000000",limitAmount:0},C=e=>({label:e?.id?e.label:y.label,limitAmount:e?.limitAmount??y.limitAmount,budgetId:e?.budgetId??y.budgetId,color:e?.color??y.color}),T=({category:e})=>{const{createNewCategory:a,updateCurrentCategory:s,fetchCategories:o}=F(),{budgets:n,fetchBudgets:d}=P(),E=n.map(r=>({label:r.label,value:r.id})),[c,x]=f.useState(()=>C(e)),[m,u]=f.useState({});f.useEffect(()=>{x(C(e))},[e]);const k=(r,h)=>{x(i=>({...i,[r]:h})),m[r]&&u(i=>{const g={...i};return delete g[r],g})};f.useEffect(()=>{o(),d()},[d,o]);const L=()=>{C(e),u({})},b=async()=>{const r=H.safeParse(c);if(!r.success){const h={};return r.error.issues.forEach(i=>{i.path[0]&&(h[i.path[0]]=i.message)}),u(h),!1}try{return e?.id?await s(e.id,c):await a(c),L(),!0}catch(h){const i=h;for(const g of i.errors)u(j=>({...j,[g.property]:g.message}));return!1}};return l.jsx(N,{title:e?.id?"Modifier la catégorie":"Nouvelle catégorie",actionLabel:e?.id?l.jsxs(l.Fragment,{children:[l.jsx(I,{size:16})," Éditer catégorie"]}):"Créer une nouvelle catégorie",confirmLabel:e?"Enregistrer":"Créer",cancelLabel:"Annuler",onConfirm:b,style:e?.id?"ghost":"primary",children:l.jsxs("form",{className:"flex flex-col gap-4 py-2",children:[l.jsx(W,{id:"category-label",name:"label",label:"Nom",value:c.label,onChange:r=>k("label",r),placeholder:"Ex: Alimentation",helperText:m.label,style:m.label?"error":"neutral"}),l.jsx(Z,{id:"budgetId",label:"Budget associé",value:c.budgetId,onChange:r=>k("budgetId",r.target.value),options:E,placeholder:"Sélectionner un budget",helperText:m.budgetId,style:m.budgetId?"error":"neutral"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("div",{className:"pt-1",children:l.jsx("input",{type:"color",className:"border-base-300 h-10 w-12 cursor-pointer rounded-lg border-2 p-1",value:c.color||"#000000",onChange:r=>k("color",r.target.value)})}),l.jsx("div",{className:"flex-1",children:l.jsx(W,{id:"category-limitAmount",name:"limitAmount",label:"Plafond (€)",type:"number",value:c.limitAmount?.toString(),onChange:r=>k("limitAmount",parseFloat(r)||0),placeholder:"0.00",helperText:m.limitAmount})})]})]})})};T.__docgenInfo={description:"",methods:[],displayName:"CategoryModal",props:{category:{required:!1,tsType:{name:"Category"},description:""}}};export{T as C,A as I,z as r};
