import{r as e,j as l}from"./iframe-Wj2LhPGt.js";import{p as N}from"./IconBase.es-CJwHKbDz.js";import{o as A}from"./TrendUp.es-FZYlZJN6.js";import{B as y}from"./Button-IqzwB7DN.js";import{I as x}from"./InputField-bzG3qRsC.js";import{M as I}from"./Modal-BYWD3ZOM.js";import{S as M}from"./Select-DWhgfQH2.js";import{o as j,s as f,a as w}from"./schemas-D3hWGOKU.js";import{n as F}from"./coerce-Cd9CS-hv.js";import{u as T,a as P}from"./frequenciesStore-bnybFUo2.js";import"./transactionsStore-C6f1lkb0.js";const Z=new Map([["bold",e.createElement(e.Fragment,null,e.createElement("path",{d:"M244,128v64a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h35l-67-67-31.51,31.52a12,12,0,0,1-17,0l-72-72a12,12,0,0,1,17-17L96,119l31.51-31.52a12,12,0,0,1,17,0L220,163V128a12,12,0,0,1,24,0Z"}))],["duotone",e.createElement(e.Fragment,null,e.createElement("path",{d:"M232,128v64H168Z",opacity:"0.2"}),e.createElement("path",{d:"M235.06,120.61a8,8,0,0,0-8.72,1.73L200,148.69,141.66,90.34a8,8,0,0,0-11.32,0L96,124.69,29.66,58.34A8,8,0,0,0,18.34,69.66l72,72a8,8,0,0,0,11.32,0L136,107.31,188.69,160l-26.35,26.34A8,8,0,0,0,168,200h64a8,8,0,0,0,8-8V128A8,8,0,0,0,235.06,120.61ZM224,184H187.31L224,147.31Z"}))],["fill",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L188.69,160,136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L200,148.69l26.34-26.35A8,8,0,0,1,240,128Z"}))],["light",e.createElement(e.Fragment,null,e.createElement("path",{d:"M238,128v64a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h49.52L136,104.49l-35.76,35.75a6,6,0,0,1-8.48,0l-72-72a6,6,0,0,1,8.48-8.48L96,127.51l35.76-35.75a6,6,0,0,1,8.48,0L226,177.52V128a6,6,0,0,1,12,0Z"}))],["regular",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h44.69L136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L224,172.69V128a8,8,0,0,1,16,0Z"}))],["thin",e.createElement(e.Fragment,null,e.createElement("path",{d:"M236,128v64a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h54.34L136,101.66,98.83,138.83a4,4,0,0,1-5.66,0l-72-72a4,4,0,0,1,5.66-5.66L96,130.34l37.17-37.17a4,4,0,0,1,5.66,0L228,182.34V128a4,4,0,0,1,8,0Z"}))]]),C=e.forwardRef((t,m)=>e.createElement(N,{ref:m,...t,weights:Z}));C.displayName="TrendDownIcon";const H=j({label:f().min(1,"Le label est requis"),type:w(["EXPENSE","INCOME"]).default("EXPENSE"),limitAmount:F({invalid_type_error:"Le montant doit être un nombre"}).optional().nullable(),budgetId:f().min(1,"Veuillez sélectionner un budget"),color:f().optional()}),h={label:"",budgetId:"",color:"#F0F",limitAmount:0},E=t=>({label:t?.id?t.label:h.label,limitAmount:t?.limitAmount??h.limitAmount,budgetId:t?.budgetId??h.budgetId,color:t?.color??h.color,type:t?.id?t.type:"EXPENSE"}),O=t=>{const{createNewCategory:m,updateCurrentCategory:r,loading:i}=T(),{budgets:s}=P(),[d,p]=e.useState(()=>E(t)),[g,a]=e.useState({}),v=(o,u)=>{p(n=>({...n,[o]:u})),g[o]&&a(n=>{const c={...n};return delete c[o],c})},b=()=>{E(t),a({})},L=async()=>{const o=H.safeParse(d);if(!o.success){const u={};return o.error.issues.forEach(n=>{n.path[0]&&(u[n.path[0]]=n.message)}),a(u),!1}try{return t?.id?await r(t.id,d):await m(d),b(),!0}catch(u){const n=u;for(const c of n.errors)a(S=>({...S,[c.property]:c.message}));return!1}};return e.useEffect(()=>{p(E(t))},[t]),{formState:d,errors:g,handleChange:v,handleSubmit:L,resetForm:b,budgetOptions:s.map(o=>({label:o.label,value:o.id})),loading:i}},V=({category:t,onClose:m})=>{const{formState:r,errors:i,handleChange:s,handleSubmit:d,budgetOptions:p,loading:g}=O(t);return l.jsx(I,{loading:g,isOpen:!0,onClose:m,onCancel:m,title:t?.id?"Modifier la catégorie":"Nouvelle catégorie",cancelLabel:"Annuler",confirmLabel:t?"Enregistrer":"Créer",onConfirm:d,style:t?.id?"ghost":"primary",children:l.jsxs("form",{className:"flex flex-col gap-4 py-2",children:[l.jsxs("div",{className:"bg-base-200 flex w-full justify-around gap-2 rounded-lg p-1",children:[l.jsx(y,{style:r.type==="EXPENSE"?"danger":"ghost",icon:C,onClick:()=>s("type","EXPENSE"),children:"Dépense"}),l.jsx(y,{style:r.type==="INCOME"?"primary":"ghost",icon:A,onClick:()=>s("type","INCOME"),children:"Revenu"})]}),l.jsx(x,{id:"category-label",name:"label",label:"Nom",value:r.label,onChange:a=>s("label",a),placeholder:"Ex: Alimentation",helperText:i.label,style:i.label?"error":"neutral"}),l.jsx(M,{id:"budgetId",label:"Budget associé",value:r.budgetId,onChange:a=>s("budgetId",a.target.value),options:p,placeholder:"Sélectionner un budget",helperText:i.budgetId,style:i.budgetId?"error":"neutral"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("div",{className:"rounded-circle h-10 w-10 overflow-hidden",children:l.jsx("input",{type:"color",className:"h-full w-full cursor-pointer rounded-full border-none",value:r.color,onChange:a=>s("color",a.target.value)})}),r.type==="EXPENSE"&&l.jsx("div",{className:"flex-1",children:l.jsx(x,{id:"category-limitAmount",name:"limitAmount",label:"Plafond (€)",type:"number",value:r.limitAmount?.toString()??"",onChange:a=>s("limitAmount",parseFloat(a)||0),placeholder:"0.00",helperText:i.limitAmount})})]})]})})};V.__docgenInfo={description:"",methods:[],displayName:"CategoryModal",props:{category:{required:!1,tsType:{name:"Category"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{V as C,C as e};
