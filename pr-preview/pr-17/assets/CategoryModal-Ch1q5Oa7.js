import{r as e,j as r}from"./iframe-D4VSmP3U.js";import{p as S}from"./IconBase.es-DHIm6gN2.js";import{o as N}from"./TrendUp.es-079BcNJO.js";import{B as E}from"./Button-CVT1imKt.js";import{I as y}from"./InputField-C3UglV6P.js";import{M as A}from"./Modal-DH-xRjnH.js";import{S as I}from"./Select-D58SJ15u.js";import{o as M,s as h,a as j}from"./schemas-D3hWGOKU.js";import{n as w}from"./coerce-Cd9CS-hv.js";import{u as F,b as T}from"./frequenciesStore-BfCbsCPo.js";import"./transactionsStore-tb0P0HZh.js";const P=new Map([["bold",e.createElement(e.Fragment,null,e.createElement("path",{d:"M244,128v64a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h35l-67-67-31.51,31.52a12,12,0,0,1-17,0l-72-72a12,12,0,0,1,17-17L96,119l31.51-31.52a12,12,0,0,1,17,0L220,163V128a12,12,0,0,1,24,0Z"}))],["duotone",e.createElement(e.Fragment,null,e.createElement("path",{d:"M232,128v64H168Z",opacity:"0.2"}),e.createElement("path",{d:"M235.06,120.61a8,8,0,0,0-8.72,1.73L200,148.69,141.66,90.34a8,8,0,0,0-11.32,0L96,124.69,29.66,58.34A8,8,0,0,0,18.34,69.66l72,72a8,8,0,0,0,11.32,0L136,107.31,188.69,160l-26.35,26.34A8,8,0,0,0,168,200h64a8,8,0,0,0,8-8V128A8,8,0,0,0,235.06,120.61ZM224,184H187.31L224,147.31Z"}))],["fill",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L188.69,160,136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L200,148.69l26.34-26.35A8,8,0,0,1,240,128Z"}))],["light",e.createElement(e.Fragment,null,e.createElement("path",{d:"M238,128v64a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h49.52L136,104.49l-35.76,35.75a6,6,0,0,1-8.48,0l-72-72a6,6,0,0,1,8.48-8.48L96,127.51l35.76-35.75a6,6,0,0,1,8.48,0L226,177.52V128a6,6,0,0,1,12,0Z"}))],["regular",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h44.69L136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L224,172.69V128a8,8,0,0,1,16,0Z"}))],["thin",e.createElement(e.Fragment,null,e.createElement("path",{d:"M236,128v64a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h54.34L136,101.66,98.83,138.83a4,4,0,0,1-5.66,0l-72-72a4,4,0,0,1,5.66-5.66L96,130.34l37.17-37.17a4,4,0,0,1,5.66,0L228,182.34V128a4,4,0,0,1,8,0Z"}))]]),x=e.forwardRef((t,m)=>e.createElement(S,{ref:m,...t,weights:P}));x.displayName="TrendDownIcon";const Z=M({label:h().min(1,"Le label est requis"),type:j(["EXPENSE","INCOME"]).default("EXPENSE"),limitAmount:w({invalid_type_error:"Le montant doit être un nombre"}).optional().nullable(),budgetId:h().min(1,"Veuillez sélectionner un budget"),color:h().optional()}),g={label:"",budgetId:"",color:"#F0F",limitAmount:0},f=t=>({label:t?.id?t.label:g.label,limitAmount:t?.limitAmount??g.limitAmount,budgetId:t?.budgetId??g.budgetId,color:t?.color??g.color,type:t?.id?t.type:"EXPENSE"}),H=t=>{const{createNewCategory:m,updateCurrentCategory:o}=F(),{budgets:i}=T(),[l,c]=e.useState(()=>f(t)),[p,a]=e.useState({}),C=(n,u)=>{c(s=>({...s,[n]:u})),p[n]&&a(s=>{const d={...s};return delete d[n],d})},b=()=>{f(t),a({})},v=async()=>{const n=Z.safeParse(l);if(!n.success){const u={};return n.error.issues.forEach(s=>{s.path[0]&&(u[s.path[0]]=s.message)}),a(u),!1}try{return t?.id?await o(t.id,l):await m(l),b(),!0}catch(u){const s=u;for(const d of s.errors)a(L=>({...L,[d.property]:d.message}));return!1}};return e.useEffect(()=>{c(f(t))},[t]),{formState:l,errors:p,handleChange:C,handleSubmit:v,resetForm:b,budgetOptions:i.map(n=>({label:n.label,value:n.id}))}},O=({category:t,onClose:m})=>{const{formState:o,errors:i,handleChange:l,handleSubmit:c,budgetOptions:p}=H(t);return r.jsx(A,{isOpen:!0,onClose:m,onCancel:m,title:t?.id?"Modifier la catégorie":"Nouvelle catégorie",cancelLabel:"Annuler",confirmLabel:t?"Enregistrer":"Créer",onConfirm:c,style:t?.id?"ghost":"primary",children:r.jsxs("form",{className:"flex flex-col gap-4 py-2",children:[r.jsxs("div",{className:"bg-base-200 flex w-full justify-around gap-2 rounded-lg p-1",children:[r.jsx(E,{style:o.type==="EXPENSE"?"danger":"ghost",icon:x,onClick:()=>l("type","EXPENSE"),children:"Dépense"}),r.jsx(E,{style:o.type==="INCOME"?"primary":"ghost",icon:N,onClick:()=>l("type","INCOME"),children:"Revenu"})]}),r.jsx(y,{id:"category-label",name:"label",label:"Nom",value:o.label,onChange:a=>l("label",a),placeholder:"Ex: Alimentation",helperText:i.label,style:i.label?"error":"neutral"}),r.jsx(I,{id:"budgetId",label:"Budget associé",value:o.budgetId,onChange:a=>l("budgetId",a.target.value),options:p,placeholder:"Sélectionner un budget",helperText:i.budgetId,style:i.budgetId?"error":"neutral"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("div",{className:"rounded-circle h-10 w-10 overflow-hidden",children:r.jsx("input",{type:"color",className:"h-full w-full cursor-pointer rounded-full border-none",value:o.color,onChange:a=>l("color",a.target.value)})}),o.type==="EXPENSE"&&r.jsx("div",{className:"flex-1",children:r.jsx(y,{id:"category-limitAmount",name:"limitAmount",label:"Plafond (€)",type:"number",value:o.limitAmount?.toString()??"",onChange:a=>l("limitAmount",parseFloat(a)||0),placeholder:"0.00",helperText:i.limitAmount})})]})]})})};O.__docgenInfo={description:"",methods:[],displayName:"CategoryModal",props:{category:{required:!1,tsType:{name:"Category"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{O as C,x as e};
