import{r as g,j as e}from"./iframe-CMb7vl1G.js";import{c as h}from"./index-DutoEiXV.js";import{A as j}from"./ActionMenu-sSdu0xn_.js";import{D as N}from"./Dot-DPis5-vO.js";import{P as f}from"./ProgressBar-DTomBrJN.js";import{o as S}from"./PencilSimple.es-Cc3J_uSG.js";import{r as v}from"./Trash.es-Dh5TNsS5.js";import{a as B}from"./schemas-BXO9pZBR.js";import"./frequenciesStore-B_BKIwyc.js";import"./transactionsStore-jUfEBfAg.js";import{B as w}from"./BudgetModal-CGOhb6PC.js";function C(s,i,m){const l=(a,c)=>a===0?u.Neutral:a>c?u.Error:a===c?u.Warning:u.Success,t=g.useMemo(()=>l(s,i),[s,i]),r=g.useMemo(()=>m?.map(a=>({id:a.id,status:l(a.currentAmount,a.limitAmount)}))??[],[m]);return{globalStatus:t,categoriesStatus:r}}function M(s){const{deleteBudgetById:i}=B(),m=g.useMemo(()=>{const o=s?.budget?.id;return o?[{label:"Éditer budget",icon:S,render:g.createElement(w,{budget:s.budget}),style:"ghost"},{label:"Supprimer",icon:v,style:"danger",onClick:()=>i(o)}]:[]},[i,s]),l=g.useMemo(()=>{const o=new Intl.NumberFormat("fr-FR",{notation:"compact",compactDisplay:"short"});return(x,b)=>`${o.format(x)} / ${o.format(b)}`},[]),t=g.useMemo(()=>{const{budget:o}=s,b=(o.categories??[]).map(n=>{const d=(n.transactions??[]).reduce((p,A)=>p+Math.abs(A.amount),0);return{id:n.id,label:n.label,currentAmount:d,limitAmount:Number(n.limitAmount),ratio:l(d,Number(n.limitAmount))}});return{id:o.id,label:o.label,currentAmount:b.reduce((n,d)=>n+d.currentAmount,0),limitAmount:b.reduce((n,d)=>n+d.limitAmount,0),categories:b}},[l,s]),{globalStatus:r,categoriesStatus:a}=C(t.currentAmount,t.limitAmount,t.categories),c={color:s.budget.color||"#000",globalStatus:r,categoriesStatus:a,label:s.budget.label,currentAmount:t.currentAmount,limitAmount:t.limitAmount,ratio:l(t.currentAmount,t.limitAmount),categories:t.categories};return{menuActions:m,globalStatus:r,categoriesStatus:a,formattedBudget:c}}const u={Neutral:"neutral",Success:"success",Warning:"warning",Error:"error"},E=h(["card bg-base-100 w-full rounded-md border lg:mx-auto"],{variants:{status:{[u.Neutral]:"border-neutral",[u.Success]:"border-success",[u.Warning]:"border-warning",[u.Error]:"border-error"}},defaultVariants:{status:u.Neutral}}),y=({budget:s})=>{const{menuActions:i,globalStatus:m,categoriesStatus:l,formattedBudget:t}=M({budget:s,onEditTransaction(r){console.log("(ouverture modal) Ajout transaction pour le budget avec id :",r)},onAddCategories(r){console.log("(ouverture modal) Ajout catégorie pour le budget avec id :",r)}});return e.jsx("div",{className:E({status:t.globalStatus}),children:e.jsxs("div",{className:"card-body p-4! shadow-lg sm:p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-3",children:[e.jsx(N,{color:t.color}),e.jsx("h2",{className:"card-title text-neutral text-md truncate font-extrabold sm:text-xl",title:t.label,children:t.label})]}),e.jsx(j,{actions:i})]}),e.jsxs("div",{className:"mb-5 flex items-center justify-between gap-2 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(f,{value:t.currentAmount,max:t.limitAmount,color:t.globalStatus,className:"h-2.5"})}),e.jsx("div",{className:"text-neutral w-fit text-right text-sm font-semibold",children:t.ratio})]}),e.jsx("hr",{className:"bg-base-300 mb-5 h-px w-full border-none"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[t.categories.map(r=>{const a=l.find(c=>c.id===r.id)?.status??m;return e.jsxs("div",{className:"flex items-center justify-between gap-x-4 gap-y-1 text-sm",children:[e.jsx("span",{className:"text-neutral w-2/3 truncate text-base font-medium",title:r.label,children:r.label}),e.jsx(f,{value:r.currentAmount,max:r.limitAmount,color:a,className:"h-2"}),e.jsx("span",{className:"text-neutral w-1/3 text-right font-medium whitespace-nowrap",children:r.ratio})]},r.id)}),t.categories.length===0&&e.jsx("p",{className:"text-neutral/40 py-2 text-center text-sm italic",children:"Aucune catégorie"})]})]})})};y.__docgenInfo={description:"",methods:[],displayName:"BudgetCard"};export{y as B};
