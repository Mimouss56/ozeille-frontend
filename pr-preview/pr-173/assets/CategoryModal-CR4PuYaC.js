import{r as e,j as l}from"./iframe-DqSXt728.js";import{o as A}from"./Pencil.es-LoVeXpI_.js";import{p as I}from"./IconBase.es-B9QtdQtA.js";import{o as S}from"./TrendUp.es-B6TO45bI.js";import{o as j,s as p,b as M,u as F,a as w}from"./schemas-nfZSsLKx.js";import{n as P}from"./coerce-D-j0bW5x.js";import{B as b}from"./Button-DOzBj5Py.js";import{I as E}from"./InputField-DE2OsRyP.js";import{M as T}from"./Modal-ACFwkXZ_.js";import{S as Z}from"./Select-BPaTE3Ef.js";const H=new Map([["bold",e.createElement(e.Fragment,null,e.createElement("path",{d:"M244,128v64a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h35l-67-67-31.51,31.52a12,12,0,0,1-17,0l-72-72a12,12,0,0,1,17-17L96,119l31.51-31.52a12,12,0,0,1,17,0L220,163V128a12,12,0,0,1,24,0Z"}))],["duotone",e.createElement(e.Fragment,null,e.createElement("path",{d:"M232,128v64H168Z",opacity:"0.2"}),e.createElement("path",{d:"M235.06,120.61a8,8,0,0,0-8.72,1.73L200,148.69,141.66,90.34a8,8,0,0,0-11.32,0L96,124.69,29.66,58.34A8,8,0,0,0,18.34,69.66l72,72a8,8,0,0,0,11.32,0L136,107.31,188.69,160l-26.35,26.34A8,8,0,0,0,168,200h64a8,8,0,0,0,8-8V128A8,8,0,0,0,235.06,120.61ZM224,184H187.31L224,147.31Z"}))],["fill",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L188.69,160,136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L200,148.69l26.34-26.35A8,8,0,0,1,240,128Z"}))],["light",e.createElement(e.Fragment,null,e.createElement("path",{d:"M238,128v64a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h49.52L136,104.49l-35.76,35.75a6,6,0,0,1-8.48,0l-72-72a6,6,0,0,1,8.48-8.48L96,127.51l35.76-35.75a6,6,0,0,1,8.48,0L226,177.52V128a6,6,0,0,1,12,0Z"}))],["regular",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h44.69L136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L224,172.69V128a8,8,0,0,1,16,0Z"}))],["thin",e.createElement(e.Fragment,null,e.createElement("path",{d:"M236,128v64a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h54.34L136,101.66,98.83,138.83a4,4,0,0,1-5.66,0l-72-72a4,4,0,0,1,5.66-5.66L96,130.34l37.17-37.17a4,4,0,0,1,5.66,0L228,182.34V128a4,4,0,0,1,8,0Z"}))]]),f=e.forwardRef((t,c)=>e.createElement(I,{ref:c,...t,weights:H}));f.displayName="TrendDownIcon";const V=j({label:p().min(1,"Le label est requis"),type:M(["EXPENSE","INCOME"]).default("EXPENSE"),limitAmount:P({invalid_type_error:"Le montant doit être un nombre"}).optional().nullable(),budgetId:p().min(1,"Veuillez sélectionner un budget"),color:p().optional()}),u={label:"",budgetId:"",color:"#000000",limitAmount:0},g=t=>({label:t?.id?t.label:u.label,limitAmount:t?.limitAmount??u.limitAmount,budgetId:t?.budgetId??u.budgetId,color:t?.color??u.color,type:t?.id?t.type:"EXPENSE"}),X=({category:t})=>{const{createNewCategory:c,updateCurrentCategory:x}=F(),{budgets:L}=w(),y=L.map(a=>({label:a.label,value:a.id})),[r,h]=e.useState(()=>g(t)),[n,d]=e.useState({});e.useEffect(()=>{h(g(t))},[t]);const s=(a,i)=>{h(o=>({...o,[a]:i})),n[a]&&d(o=>{const m={...o};return delete m[a],m})},C=()=>{g(t),d({})},v=async()=>{const a=V.safeParse(r);if(!a.success){const i={};return a.error.issues.forEach(o=>{o.path[0]&&(i[o.path[0]]=o.message)}),d(i),!1}try{return t?.id?await x(t.id,r):await c(r),C(),!0}catch(i){const o=i;for(const m of o.errors)d(N=>({...N,[m.property]:m.message}));return!1}};return l.jsx(T,{title:t?.id?"Modifier la catégorie":"Nouvelle catégorie",actionLabel:t?.id?l.jsxs(l.Fragment,{children:[l.jsx(A,{size:16})," Éditer catégorie"]}):"Créer une nouvelle catégorie",confirmLabel:t?"Enregistrer":"Créer",cancelLabel:"Annuler",onConfirm:v,style:t?.id?"ghost":"primary",children:l.jsxs("form",{className:"flex flex-col gap-4 py-2",children:[l.jsxs("div",{className:"bg-base-200 flex w-full justify-around gap-2 rounded-lg p-1",children:[l.jsx(b,{style:r.type==="EXPENSE"?"danger":"ghost",icon:f,onClick:()=>s("type","EXPENSE"),children:"Dépense"}),l.jsx(b,{style:r.type==="INCOME"?"primary":"ghost",icon:S,onClick:()=>s("type","INCOME"),children:"Revenu"})]}),l.jsx(E,{id:"category-label",name:"label",label:"Nom",value:r.label,onChange:a=>s("label",a),placeholder:"Ex: Alimentation",helperText:n.label,style:n.label?"error":"neutral"}),l.jsx(Z,{id:"budgetId",label:"Budget associé",value:r.budgetId,onChange:a=>s("budgetId",a.target.value),options:y,placeholder:"Sélectionner un budget",helperText:n.budgetId,style:n.budgetId?"error":"neutral"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("div",{className:"pt-1",children:l.jsx("input",{type:"color",className:"border-base-300 h-10 w-12 cursor-pointer rounded-lg border-2 p-1",value:r.color||"#000000",onChange:a=>s("color",a.target.value)})}),r.type==="EXPENSE"&&l.jsx("div",{className:"flex-1",children:l.jsx(E,{id:"category-limitAmount",name:"limitAmount",label:"Plafond (€)",type:"number",value:r.limitAmount?.toString()??"",onChange:a=>s("limitAmount",parseFloat(a)||0),placeholder:"0.00",helperText:n.limitAmount})})]})]})})};X.__docgenInfo={description:"",methods:[],displayName:"CategoryModal",props:{category:{required:!1,tsType:{name:"Category"},description:""}}};export{X as C};
