import{r as g,j as t}from"./iframe-BZq4Wtp5.js";import{o as j}from"./Pencil.es-_McJtFjr.js";import{I as y}from"./InputField-DWfaQk9d.js";import{M as B}from"./Modal-jpvhc8i-.js";import{o as C,s as x,a as v}from"./schemas-CCie32F6.js";import"./frequenciesStore-COjLgSS9.js";import"./transactionsStore-59ml0mx0.js";const w=C({label:x().min(1,"Le label est requis"),color:x().regex(/^#[0-9a-fA-F]{6}$/,{message:"Code couleur invalide. Doit contenir au moins 7 charactères (ex: #RRGGBB)."})}),E=w.extend({}),f={label:"",color:"#000000"},F=e=>{const{updateCurrentBudget:i,createNewBudget:m}=v(),[r,o]=g.useState({label:e?.label?e.label:f.label,color:e?.color?e?.color:f.color}),[u,s]=g.useState({}),p=l=>d=>{o(n=>({...n,[l]:d})),u[l]&&s(n=>{const a={...n};return delete a[l],a})},h=()=>{o(f),s({})};return{handleSubmit:async l=>{l.preventDefault();const d=E.safeParse(r);if(!d.success){const a={};return d.error.issues.forEach(c=>{c.path[0]&&(a[c.path[0]]=c.message)}),s(a),!1}const n={...r,label:r.label,color:r.color};try{return e?.id?await i(e.id,n):await m({...r}),h(),!0}catch(a){const c=a;for(const b of c.errors)s(S=>({...S,[b.property]:b.message}));return!1}},resetForm:h,errors:u,formState:r,handleChange:p,setFormState:o}},N=({budget:e})=>{const{handleSubmit:i,resetForm:m,errors:r,formState:o,handleChange:u,setFormState:s}=F(e);return t.jsx(B,{title:e?.id?"Éditer un budget":"Créer un nouveau budget",cancelLabel:"Annuler",actionLabel:e?.id?t.jsxs(t.Fragment,{children:[t.jsx(j,{size:16})," Éditer le budget"]}):"Créer un nouveau budget",style:e?.id?"ghost":"primary",onConfirm:i,onCancel:m,children:t.jsxs("form",{onSubmit:i,className:"flex justify-between gap-2 align-baseline md:gap-4",children:[t.jsx("div",{className:"flex-1",children:t.jsx(y,{id:"budget_label",name:"label",type:"text",label:"Nom du budget",placeholder:"Ex: Courses alimentaires",value:o.label,style:r.label?"error":"neutral",helperText:r.label,onChange:u("label")})}),t.jsx("div",{className:"rounded-circle h-10 w-10 overflow-hidden",children:t.jsx("input",{type:"color",className:"h-full w-full cursor-pointer rounded-full border-none",value:o.color,onChange:p=>s({...o,color:p.target.value})})})]})})};N.__docgenInfo={description:"",methods:[],displayName:"BudgetModal",props:{budget:{required:!1,tsType:{name:"Budget"},description:""}}};export{N as B};
