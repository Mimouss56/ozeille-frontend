import{r as g,j as e}from"./iframe-DpTib-Zx.js";import{c as N}from"./index-DutoEiXV.js";import{A as j}from"./ActionMenu-B-EHJUVm.js";import{D as S}from"./Dot-C91kFYVj.js";import{P as p}from"./ProgressBar-BnVg48zE.js";import{o as B}from"./PencilSimple.es-sZA3RnK_.js";import{r as w}from"./Trash.es-CBo7FWEE.js";import{a as v}from"./schemas-BGkEtAWS.js";import"./frequenciesStore-TFRlud_Q.js";import"./transactionsStore-B82R3cR6.js";import{B as C}from"./BudgetModal-fLS96xxl.js";function E(r,l,m){const u=(a,c)=>a===0?i.Neutral:a>c?i.Error:a===c?i.Warning:i.Success,t=g.useMemo(()=>u(r,l),[r,l]),s=g.useMemo(()=>m?.map(a=>({id:a.id,status:u(a.currentAmount,a.limitAmount)}))??[],[m]);return{globalStatus:t,categoriesStatus:s}}function y(r){const{deleteBudgetById:l}=v(),m=g.useMemo(()=>{const n=r?.budget?.id;return n?[{label:"Éditer budget",icon:B,render:g.createElement(C,{budget:r.budget}),style:"ghost"},{label:"Supprimer",icon:w,style:"danger",onClick:()=>l(n)}]:[]},[l,r]),u=g.useMemo(()=>{const n=new Intl.NumberFormat("fr-FR",{notation:"compact",compactDisplay:"short"});return(b,f)=>`${n.format(b)} / ${n.format(f)}`},[]),t=g.useMemo(()=>{const{budget:n}=r,x=(n.categories??[]).filter(o=>o.type==="EXPENSE"||!o.type).map(o=>{const d=(o.transactions??[]).reduce((h,A)=>h+Math.abs(A.amount),0);return{id:o.id,label:o.label,currentAmount:d,limitAmount:Number(o.limitAmount),ratio:u(d,Number(o.limitAmount))}});return{id:n.id,label:n.label,currentAmount:x.reduce((o,d)=>o+d.currentAmount,0),limitAmount:x.reduce((o,d)=>o+d.limitAmount,0),categories:x}},[u,r]),{globalStatus:s,categoriesStatus:a}=E(t.currentAmount,t.limitAmount,t.categories),c={color:r.budget.color||"#000",globalStatus:s,categoriesStatus:a,label:r.budget.label,currentAmount:t.currentAmount,limitAmount:t.limitAmount,ratio:u(t.currentAmount,t.limitAmount),categories:t.categories};return{menuActions:m,globalStatus:s,categoriesStatus:a,formattedBudget:c}}const i={Neutral:"neutral",Success:"success",Warning:"warning",Error:"error"},M=N(["card bg-base-100 w-full rounded-md border lg:mx-auto transition-all"],{variants:{status:{[i.Neutral]:"border-neutral",[i.Success]:"border-success",[i.Warning]:"border-warning",[i.Error]:"border-error"}},defaultVariants:{status:i.Neutral}}),D=({budget:r})=>{const{menuActions:l,globalStatus:m,categoriesStatus:u,formattedBudget:t}=y({budget:r});return e.jsx("div",{className:M({status:t.globalStatus}),children:e.jsxs("div",{className:"card-body p-4! shadow-lg sm:p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-3",children:[e.jsx(S,{color:t.color}),e.jsx("h2",{className:"card-title text-neutral text-md truncate font-extrabold sm:text-xl",title:t.label,children:t.label})]}),e.jsx(j,{actions:l})]}),e.jsxs("div",{className:"mb-5 flex items-center justify-between gap-2 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(p,{value:t.currentAmount,max:t.limitAmount,color:t.globalStatus,className:"h-2.5"})}),e.jsx("div",{className:"text-neutral w-fit text-right text-sm font-semibold",children:t.ratio})]}),e.jsx("hr",{className:"bg-base-300 mb-5 h-px w-full border-none"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[t.categories.map(s=>{const a=u.find(c=>c.id===s.id)?.status??m;return e.jsxs("div",{className:"flex items-center justify-between gap-x-4 gap-y-1 text-sm",children:[e.jsx("span",{className:"text-neutral w-2/3 truncate text-base font-medium",title:s.label,children:s.label}),e.jsx(p,{value:s.currentAmount,max:s.limitAmount,color:a,className:"h-2"}),e.jsx("span",{className:"text-neutral w-1/3 text-right font-medium whitespace-nowrap",children:s.ratio})]},s.id)}),t.categories.length===0&&e.jsx("p",{className:"text-neutral/40 py-2 text-center text-sm italic",children:"Aucune catégorie"})]})]})})};D.__docgenInfo={description:"",methods:[],displayName:"BudgetCard"};export{D as B};
