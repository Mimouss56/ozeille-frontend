import{r as t,j as o}from"./iframe-B0cFNXg8.js";import{o as E}from"./Pencil.es-BW4kW3SL.js";import{B as j}from"./Button-CKRTuond.js";import{D}from"./DataTable-BQp5hjpK.js";import{T as I}from"./TransactionDeleteModal-CQgxu8KK.js";import{T as k}from"./TransactionModal-DS9sQa5X.js";import{A as N}from"./ActionMenu-D69xklNw.js";import{u as O}from"./schemas-XSs--JG5.js";import{u as P}from"./frequenciesStore-Cew-QqY2.js";import{u as v}from"./transactionsStore-mfnfGV1I.js";function A(){const[u,a]=t.useState(void 0),[m,l]=t.useState(!1),[g,c]=t.useState(!1),{fetchTransactions:r,meta:p,transactions:i}=v(),{fetchCategories:s,categories:n}=O(),{fetchFrequencies:d,frequencies:x}=P(),M=t.useCallback(()=>{a(void 0),l(!0)},[]),f=t.useCallback(e=>{a(e),l(!0)},[]),h=t.useCallback(e=>{a(e),c(!0)},[]),b=t.useCallback(()=>{l(!1),c(!1),a(void 0)},[]),C=t.useCallback(e=>[{label:"Éditer",style:"outline",onClick:()=>f(e)},{label:"Supprimer",style:"dangerOutline",onClick:()=>h(e)}],[f,h]),y=t.useMemo(()=>[{accessorKey:"dueAt",header:"Date",cell:({row:e})=>new Date(e.original.dueAt).toLocaleDateString()},{accessorKey:"category",header:"Catégorie",cell:({row:e})=>e.original.categoryId?`${e.original.category?.label}`:"Aucune catégorie"},{accessorKey:"amount",header:"Montant",cell:({row:e})=>{const S=Number(e.original.amount).toFixed(2),T=e.original.category?.type==="INCOME";return t.createElement("span",{className:`font-medium ${T?"text-green-600":"text-red-600"}`},`${T?"+":""} ${S} €`)}},{accessorKey:"label",header:"Libellé"},{id:"actions",header:"",cell:({row:e})=>t.createElement(N,{actions:C(e.original)})}],[C]);return t.useEffect(()=>{n.length===0&&s(),x.length===0&&d()},[n.length,s,d,x.length]),{columns:y,fetchTransactions:r,meta:p,transactions:i,isEditModalOpen:m,isDeleteModalOpen:g,selectedTransaction:u,handleCreate:M,handleEdit:f,handleDelete:h,closeModals:b}}const K=()=>{const{columns:u,fetchTransactions:a,meta:m,transactions:l,isEditModalOpen:g,isDeleteModalOpen:c,selectedTransaction:r,handleCreate:p,closeModals:i}=A(),s=10,[n,d]=t.useState({pageIndex:0,pageSize:s});return t.useEffect(()=>{a({limit:s,page:n.pageIndex+1})},[a,s,n.pageIndex]),o.jsxs("div",{className:"flex h-full flex-col gap-4",children:[o.jsx("h1",{className:"text-neutral text-2xl font-bold",children:"Transactions"}),o.jsx("div",{className:"flex justify-end gap-4",children:o.jsx(j,{onClick:p,icon:E,children:"Nouvelle Transaction"})}),o.jsx(D,{pageSize:s,data:l,columns:u,currentPage:n,setCurrentPage:d,totalPage:m.totalPages,paginated:!0}),g&&o.jsx(k,{transaction:r,onClose:i}),c&&r&&o.jsx(I,{transaction:r,onClose:i})]})};K.__docgenInfo={description:"",methods:[],displayName:"TransactionPage"};export{K as T};
