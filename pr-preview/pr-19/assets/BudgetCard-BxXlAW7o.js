import{r as g,j as e}from"./iframe-BeLUgHeg.js";import{c as N}from"./index-DutoEiXV.js";import{A as j}from"./ActionMenu-RCBk5UmA.js";import{D as S}from"./Dot-sPqNGnvZ.js";import{P as p}from"./ProgressBar-CLcUDehQ.js";import{o as w}from"./PencilSimple.es-DwopoBCK.js";import{r as B}from"./Trash.es-CNsMd_6F.js";import{b as v}from"./frequenciesStore-DPXrJ9pX.js";import"./transactionsStore-CxinI-Bo.js";function C(s,l,m){const u=(t,c)=>t===0?i.Neutral:t>c?i.Error:t===c?i.Warning:i.Success,a=g.useMemo(()=>u(s,l),[s,l]),r=g.useMemo(()=>m?.map(t=>({id:t.id,status:u(t.currentAmount,t.limitAmount)}))??[],[m]);return{globalStatus:a,categoriesStatus:r}}function E(s){const{deleteBudgetById:l}=v(),m=g.useMemo(()=>{const n=s?.budget?.id;return n?[{label:"Éditer budget",icon:w,style:"ghost",onClick:()=>s.onEditBudget?.(s.budget)},{label:"Supprimer",icon:B,style:"danger",onClick:()=>l(n)}]:[]},[l,s]),u=g.useMemo(()=>{const n=new Intl.NumberFormat("fr-FR",{notation:"compact",compactDisplay:"short"});return(b,f)=>`${n.format(b)} / ${n.format(f)}`},[]),a=g.useMemo(()=>{const{budget:n}=s,x=(n.categories??[]).filter(o=>o.type==="EXPENSE"||!o.type).map(o=>{const d=(o.transactions??[]).reduce((h,A)=>h+Math.abs(A.amount),0);return{id:o.id,label:o.label,currentAmount:d,limitAmount:Number(o.limitAmount),ratio:u(d,Number(o.limitAmount))}});return{id:n.id,label:n.label,currentAmount:x.reduce((o,d)=>o+d.currentAmount,0),limitAmount:x.reduce((o,d)=>o+d.limitAmount,0),categories:x}},[u,s]),{globalStatus:r,categoriesStatus:t}=C(a.currentAmount,a.limitAmount,a.categories),c={color:s.budget.color||"#000",globalStatus:r,categoriesStatus:t,label:s.budget.label,currentAmount:a.currentAmount,limitAmount:a.limitAmount,ratio:u(a.currentAmount,a.limitAmount),categories:a.categories};return{menuActions:m,globalStatus:r,categoriesStatus:t,formattedBudget:c}}const i={Neutral:"neutral",Success:"success",Warning:"warning",Error:"error"},y=N(["card bg-base-100 w-full rounded-md border lg:mx-auto transition-all"],{variants:{status:{[i.Neutral]:"border-neutral",[i.Success]:"border-success",[i.Warning]:"border-warning",[i.Error]:"border-error"}},defaultVariants:{status:i.Neutral}}),M=({budget:s,onEditBudget:l})=>{const{menuActions:m,globalStatus:u,categoriesStatus:a,formattedBudget:r}=E({budget:s,onEditBudget:l});return e.jsx("div",{className:y({status:r.globalStatus}),children:e.jsxs("div",{className:"card-body p-4! shadow-lg sm:p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-3",children:[e.jsx(S,{color:r.color}),e.jsx("h2",{className:"card-title text-neutral text-md truncate font-extrabold sm:text-xl",title:r.label,children:r.label})]}),e.jsx(j,{actions:m})]}),e.jsxs("div",{className:"mb-5 flex items-center justify-between gap-2 sm:gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(p,{value:r.currentAmount,max:r.limitAmount,color:r.globalStatus,className:"h-2.5"})}),e.jsx("div",{className:"text-neutral w-fit text-right text-sm font-semibold",children:r.ratio})]}),e.jsx("hr",{className:"bg-base-300 mb-5 h-px w-full border-none"}),e.jsxs("div",{className:"flex flex-col gap-4",children:[r.categories.map(t=>{const c=a.find(n=>n.id===t.id)?.status??u;return e.jsxs("div",{className:"flex items-center justify-between gap-x-4 gap-y-1 text-sm",children:[e.jsx("span",{className:"text-neutral w-2/3 truncate text-base font-medium",title:t.label,children:t.label}),e.jsx(p,{value:t.currentAmount,max:t.limitAmount,color:c,className:"h-2"}),e.jsx("span",{className:"text-neutral w-1/3 text-right font-medium whitespace-nowrap",children:t.ratio})]},t.id)}),r.categories.length===0&&e.jsx("p",{className:"text-neutral/40 py-2 text-center text-sm italic",children:"Aucune catégorie"})]})]})})};M.__docgenInfo={description:"",methods:[],displayName:"BudgetCard"};export{M as B};
