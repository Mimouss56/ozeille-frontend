import{r as p,j as l}from"./iframe-ypTtijTa.js";import{g as S,I as y}from"./InputColor-D3ZepJfw.js";import{I as B}from"./InputField-CLc5QXxu.js";import{M as j}from"./Modal-BvEHSDOv.js";import{o as E,s as b}from"./schemas-D3hWGOKU.js";import{b as F}from"./frequenciesStore-B8LYzdyp.js";import"./transactionsStore-BTSZEaTT.js";const v=E({label:b().min(1,"Le label est requis"),color:b().regex(/^#[0-9a-fA-F]{6}$/,{message:"Code couleur invalide. Doit contenir au moins 7 charactères (ex: #RRGGBB)."})}),w=v.extend({}),x={label:"",color:S()},f=e=>({label:e?.id?e.label:x.label,color:e?.id?e.color:x.color}),M=e=>{const{updateCurrentBudget:i,createNewBudget:d}=F(),[r,t]=p.useState(()=>f(e)),[c,s]=p.useState({});p.useEffect(()=>{t(f(e))},[e]);const m=n=>u=>{t(o=>({...o,[n]:u})),c[n]&&s(o=>{const a={...o};return delete a[n],a})},g=()=>{t(f(e)),s({})};return{handleSubmit:async()=>{const n=w.safeParse(r);if(!n.success){const o={};return n.error.issues.forEach(a=>{a.path[0]&&(o[a.path[0]]=a.message)}),s(o),!1}const u={...r,label:r.label,color:r.color};try{return e?.id&&u?await i(e.id,u):await d({...r}),g(),!0}catch(o){const a=o;for(const h of a.errors)s(C=>({...C,[h.property]:h.message}));return!1}},resetForm:g,errors:c,formState:r,handleChange:m,setFormState:t}},I=({budget:e,onClose:i})=>{const{handleSubmit:d,errors:r,formState:t,handleChange:c,setFormState:s}=M(e);return l.jsx(j,{isOpen:!0,onClose:i,onCancel:i,title:e?.id?"Éditer un budget":"Créer un nouveau budget",cancelLabel:"Annuler",confirmLabel:e?.id?"Modifier":"Créer",style:e?.id?"ghost":"primary",onConfirm:d,children:l.jsxs("form",{className:"flex justify-between gap-2 align-baseline md:gap-4",children:[l.jsx("div",{className:"flex-1",children:l.jsx(B,{id:"budget_label",name:"label",type:"text",label:"Nom du budget",placeholder:"Ex: Courses alimentaires",value:t.label,style:r.label?"error":"neutral",helperText:r.label,onChange:c("label")})}),l.jsx(y,{value:t.color,onChange:m=>s({...t,color:m})})]})})};I.__docgenInfo={description:"",methods:[],displayName:"BudgetModal",props:{budget:{required:!1,tsType:{name:"Budget"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{I as B};
