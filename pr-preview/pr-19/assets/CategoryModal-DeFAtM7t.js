import{r as e,j as a}from"./iframe-0jTvucNN.js";import{p as v}from"./IconBase.es-CicBGxvv.js";import{o as A}from"./TrendUp.es-DkbrVRSa.js";import{B as C}from"./Button-80SSyK6k.js";import{g as N,I as M}from"./InputColor-8l46J0ao.js";import{I as y}from"./InputField-CqqHYrWA.js";import{S as j}from"./Select-Dkf7cP3H.js";import{M as F}from"./Modal-z4tMXMat.js";import{o as w,s as E,a as T}from"./schemas-D3hWGOKU.js";import{n as P}from"./coerce-Cd9CS-hv.js";import{u as Z,b as H}from"./frequenciesStore-Ck22w-1o.js";import"./transactionsStore-BFPZQzkT.js";const O=new Map([["bold",e.createElement(e.Fragment,null,e.createElement("path",{d:"M244,128v64a12,12,0,0,1-12,12H168a12,12,0,0,1,0-24h35l-67-67-31.51,31.52a12,12,0,0,1-17,0l-72-72a12,12,0,0,1,17-17L96,119l31.51-31.52a12,12,0,0,1,17,0L220,163V128a12,12,0,0,1,24,0Z"}))],["duotone",e.createElement(e.Fragment,null,e.createElement("path",{d:"M232,128v64H168Z",opacity:"0.2"}),e.createElement("path",{d:"M235.06,120.61a8,8,0,0,0-8.72,1.73L200,148.69,141.66,90.34a8,8,0,0,0-11.32,0L96,124.69,29.66,58.34A8,8,0,0,0,18.34,69.66l72,72a8,8,0,0,0,11.32,0L136,107.31,188.69,160l-26.35,26.34A8,8,0,0,0,168,200h64a8,8,0,0,0,8-8V128A8,8,0,0,0,235.06,120.61ZM224,184H187.31L224,147.31Z"}))],["fill",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1-5.66-13.66L188.69,160,136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L200,148.69l26.34-26.35A8,8,0,0,1,240,128Z"}))],["light",e.createElement(e.Fragment,null,e.createElement("path",{d:"M238,128v64a6,6,0,0,1-6,6H168a6,6,0,0,1,0-12h49.52L136,104.49l-35.76,35.75a6,6,0,0,1-8.48,0l-72-72a6,6,0,0,1,8.48-8.48L96,127.51l35.76-35.75a6,6,0,0,1,8.48,0L226,177.52V128a6,6,0,0,1,12,0Z"}))],["regular",e.createElement(e.Fragment,null,e.createElement("path",{d:"M240,128v64a8,8,0,0,1-8,8H168a8,8,0,0,1,0-16h44.69L136,107.31l-34.34,34.35a8,8,0,0,1-11.32,0l-72-72A8,8,0,0,1,29.66,58.34L96,124.69l34.34-34.35a8,8,0,0,1,11.32,0L224,172.69V128a8,8,0,0,1,16,0Z"}))],["thin",e.createElement(e.Fragment,null,e.createElement("path",{d:"M236,128v64a4,4,0,0,1-4,4H168a4,4,0,0,1,0-8h54.34L136,101.66,98.83,138.83a4,4,0,0,1-5.66,0l-72-72a4,4,0,0,1,5.66-5.66L96,130.34l37.17-37.17a4,4,0,0,1,5.66,0L228,182.34V128a4,4,0,0,1,8,0Z"}))]]),x=e.forwardRef((t,m)=>e.createElement(v,{ref:m,...t,weights:O}));x.displayName="TrendDownIcon";const V=w({label:E().min(1,"Le label est requis"),type:T(["EXPENSE","INCOME"]).default("EXPENSE"),limitAmount:P({invalid_type_error:"Le montant doit être un nombre"}).optional().nullable(),budgetId:E().min(1,"Veuillez sélectionner un budget"),color:E().optional()}),h={label:"",budgetId:"",color:N(),limitAmount:0},b=t=>({label:t?.id?t.label:h.label,limitAmount:t?.limitAmount??h.limitAmount,budgetId:t?.budgetId??h.budgetId,color:t?.color??h.color,type:t?.id?t.type:"EXPENSE"}),X=t=>{const{createNewCategory:m,updateCurrentCategory:l,loading:i}=Z(),{budgets:s}=H(),[u,p]=e.useState(()=>b(t)),[r,g]=e.useState({}),L=(o,d)=>{p(n=>({...n,[o]:d})),r[o]&&g(n=>{const c={...n};return delete c[o],c})},f=()=>{b(t),g({})},I=async()=>{const o=V.safeParse(u);if(!o.success){const d={};return o.error.issues.forEach(n=>{n.path[0]&&(d[n.path[0]]=n.message)}),g(d),!1}try{return t?.id?await l(t.id,u):await m(u),f(),!0}catch(d){const n=d;for(const c of n.errors)g(S=>({...S,[c.property]:c.message}));return!1}};return e.useEffect(()=>{p(b(t))},[t]),{formState:u,errors:r,handleChange:L,handleSubmit:I,resetForm:f,budgetOptions:s.map(o=>({label:o.label,value:o.id})),loading:i}},_=({category:t,onClose:m})=>{const{formState:l,errors:i,handleChange:s,handleSubmit:u,budgetOptions:p}=X(t);return a.jsx(F,{isOpen:!0,onClose:m,onCancel:m,title:t?.id?"Modifier la catégorie":"Nouvelle catégorie",cancelLabel:"Annuler",confirmLabel:t?"Enregistrer":"Créer",onConfirm:u,style:t?.id?"ghost":"primary",children:a.jsxs("form",{className:"flex flex-col gap-4 py-2",children:[a.jsxs("div",{className:"bg-base-200 flex w-full justify-around gap-2 rounded-lg p-1",children:[a.jsx(C,{style:l.type==="EXPENSE"?"danger":"ghost",icon:x,onClick:()=>s("type","EXPENSE"),children:"Dépense"}),a.jsx(C,{style:l.type==="INCOME"?"primary":"ghost",icon:A,onClick:()=>s("type","INCOME"),children:"Revenu"})]}),a.jsx(y,{id:"category-label",name:"label",label:"Nom",value:l.label,onChange:r=>s("label",r),placeholder:"Ex: Alimentation",helperText:i.label,style:i.label?"error":"neutral"}),a.jsx(j,{id:"budgetId",label:"Budget associé",value:l.budgetId,onChange:r=>s("budgetId",r.target.value),options:p,placeholder:"Sélectionner un budget",helperText:i.budgetId,style:i.budgetId?"error":"neutral"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(M,{value:l.color??"#000000",onChange:r=>s("color",r)}),l.type==="EXPENSE"&&a.jsx("div",{className:"flex-1",children:a.jsx(y,{id:"category-limitAmount",name:"limitAmount",label:"Plafond (€)",type:"number",value:l.limitAmount?.toString()??"",onChange:r=>s("limitAmount",parseFloat(r)||0),placeholder:"0.00",helperText:i.limitAmount})})]})]})})};_.__docgenInfo={description:"",methods:[],displayName:"CategoryModal",props:{category:{required:!1,tsType:{name:"Category"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{_ as C,x as e};
