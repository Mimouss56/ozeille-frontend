import{r as p,j as n}from"./iframe-BgQ_fZKJ.js";import{I as S}from"./InputField-CrXczbqr.js";import{M as B}from"./Modal-DzTZhzZr.js";import{o as C,s as b}from"./schemas-D3hWGOKU.js";import{b as j}from"./frequenciesStore-BnM9kRm6.js";import"./transactionsStore-ClaYOIKs.js";const v=C({label:b().min(1,"Le label est requis"),color:b().regex(/^#[0-9a-fA-F]{6}$/,{message:"Code couleur invalide. Doit contenir au moins 7 charactères (ex: #RRGGBB)."})}),w=v.extend({}),x={label:"",color:"#F0F"},f=e=>({label:e?.id?e.label:x.label,color:e?.id?e.color:x.color}),F=e=>{const{updateCurrentBudget:i,createNewBudget:d}=j(),[r,t]=p.useState(()=>f(e)),[c,a]=p.useState({});p.useEffect(()=>{t(f(e))},[e]);const m=l=>u=>{t(o=>({...o,[l]:u})),c[l]&&a(o=>{const s={...o};return delete s[l],s})},h=()=>{t(f(e)),a({})};return{handleSubmit:async()=>{const l=w.safeParse(r);if(!l.success){const o={};return l.error.issues.forEach(s=>{s.path[0]&&(o[s.path[0]]=s.message)}),a(o),!1}const u={...r,label:r.label,color:r.color};try{return e?.id&&u?await i(e.id,u):await d({...r}),h(),!0}catch(o){const s=o;for(const g of s.errors)a(y=>({...y,[g.property]:g.message}));return!1}},resetForm:h,errors:c,formState:r,handleChange:m,setFormState:t}},E=({budget:e,onClose:i})=>{const{handleSubmit:d,errors:r,formState:t,handleChange:c,setFormState:a}=F(e);return n.jsx(B,{isOpen:!0,onClose:i,onCancel:i,title:e?.id?"Éditer un budget":"Créer un nouveau budget",cancelLabel:"Annuler",confirmLabel:e?.id?"Modifier":"Créer",style:e?.id?"ghost":"primary",onConfirm:d,children:n.jsxs("form",{className:"flex justify-between gap-2 align-baseline md:gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsx(S,{id:"budget_label",name:"label",type:"text",label:"Nom du budget",placeholder:"Ex: Courses alimentaires",value:t.label,style:r.label?"error":"neutral",helperText:r.label,onChange:c("label")})}),n.jsx("div",{className:"rounded-circle h-10 w-10 overflow-hidden",children:n.jsx("input",{type:"color",className:"h-full w-full cursor-pointer rounded-full border-none",value:t.color,onChange:m=>a({...t,color:m.target.value})})})]})})};E.__docgenInfo={description:"",methods:[],displayName:"BudgetModal",props:{budget:{required:!1,tsType:{name:"Budget"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{E as B};
