import{r as t,j as o}from"./iframe-k3NaWi71.js";import{o as A}from"./Pencil.es-EugNF_sW.js";import{o as k}from"./Wallet.es-bz3BE5fx.js";import{B as N}from"./Button-3sfTC6nM.js";import{I as v}from"./InputField-Caw6rrGG.js";import{D as F}from"./DataTable-9Fvt9-ve.js";import{T as $}from"./TransactionDeleteModal-BKygYnyw.js";import{T as _}from"./TransactionModal-C_Qm8zN4.js";import{E as z}from"./EmptyCard-BIfEztEy.js";import{d as M}from"./dayjs.min-BySlkrVL.js";import{A as K}from"./ActionMenu-D6vl8ztT.js";import{u as L,b as R}from"./frequenciesStore-uhDM-OuG.js";import{u as q}from"./transactionsStore-Bokn52WG.js";const w={currency:"€",decimals:2,currencyPosition:"after"};function D(d,s={}){const{currency:r,decimals:l,currencyPosition:u}={...w,...s},a=d.toFixed(l),n=u==="after"?`${a} ${r}`:`${r} ${a}`,i=`${d>0?"text-green-600":"text-red-600"} font-medium`;return t.createElement("span",{className:i},n)}D.__docgenInfo={description:"",methods:[],displayName:"formatAmountWithColor"};const B=()=>M().startOf("month").format("YYYY-MM");function U(){const[d,s]=t.useState(void 0),[r,l]=t.useState(!1),[u,a]=t.useState(!1),[n,m]=t.useState(()=>B()),{fetchTransactions:i,meta:g,transactions:h}=q(),{fetchCategories:p,categories:c}=L(),{fetchFrequencies:y,frequencies:Y}=R(),f=10,[x,T]=t.useState({pageIndex:0,pageSize:f}),E=t.useCallback(e=>{m(e),T({pageIndex:0,pageSize:f})},[]),S=t.useCallback(()=>{s(void 0),l(!0)},[]),C=t.useCallback(e=>{s(e),l(!0)},[]),b=t.useCallback(e=>{s(e),a(!0)},[]),j=t.useCallback(()=>{l(!1),a(!1),s(void 0)},[]),P=t.useCallback(e=>[{label:"Éditer",style:"outline",onClick:()=>C(e)},{label:"Supprimer",style:"dangerOutline",onClick:()=>b(e)}],[C,b]),O=t.useMemo(()=>[{accessorKey:"dueAt",header:"Date",cell:({row:e})=>new Date(e.original.dueAt).toLocaleDateString()},{accessorKey:"category",header:"Catégorie",cell:({row:e})=>e.original.categoryId?`${e.original.category?.label}`:"Aucune catégorie",enableFiltering:!0,options:{filterOptions:c.map(e=>({id:e.id,label:e.label})),filterEmptyLabel:"Toutes"}},{accessorKey:"amount",header:"Montant",cell:({row:e})=>D(e.original.amount),enableFiltering:!0,options:{filterPlaceholder:"Montant"},currency:!0},{accessorKey:"label",header:"Libellé",enableFiltering:!0,options:{filterPlaceholder:"Rechercher un libellé..."}},{id:"actions",header:"",cell:({row:e})=>t.createElement(K,{actions:P(e.original)})}],[P,c]);return t.useEffect(()=>{c.length===0&&p(),Y.length===0&&y()},[c.length,p,y,Y.length]),t.useEffect(()=>{const e=M(n,"YYYY-MM").startOf("month").format("YYYY-MM-DD"),I=M(n,"YYYY-MM").endOf("month").format("YYYY-MM-DD");i({limit:f,page:x.pageIndex+1,from:e,to:I})},[i,f,x.pageIndex,n]),{columns:O,fetchTransactions:i,meta:g,transactions:h,isEditModalOpen:r,isDeleteModalOpen:u,selectedTransaction:d,handleCreate:S,handleEdit:C,handleDelete:b,closeModals:j,page:x,setPage:T,limit:f,period:n,handlePeriodChange:E,categories:c}}const W=()=>{const{columns:d,meta:s,transactions:r,isEditModalOpen:l,isDeleteModalOpen:u,selectedTransaction:a,handleCreate:n,closeModals:m,page:i,setPage:g,limit:h,period:p,handlePeriodChange:c}=U();return o.jsxs("div",{className:"flex h-full flex-col gap-4",children:[o.jsx("h1",{className:"text-neutral text-2xl font-bold",children:"Transactions"}),o.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[o.jsx(v,{id:"transaction-period",label:"Période",name:"period",type:"month",value:p,onChange:c,size:"sm",placeholder:""}),o.jsx(N,{onClick:n,icon:A,children:"Nouvelle Transaction"})]}),r.length===0&&o.jsx(z,{icon:k,label:"Aucune transaction",subtitle:"Ajouter une nouvelle transaction"}),o.jsx(F,{pageSize:h,data:r,columns:d,currentPage:i,setCurrentPage:g,totalPage:s.totalPages,paginated:!0}),l&&o.jsx(_,{transaction:a,onClose:m}),u&&a&&o.jsx($,{transaction:a,onClose:m})]})};W.__docgenInfo={description:"",methods:[],displayName:"TransactionPage"};export{W as T};
