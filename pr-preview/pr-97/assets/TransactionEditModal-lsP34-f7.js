import{r as h,R as t,j as o}from"./iframe-CwMXMrUU.js";import{o as C,s as d,u as L,a as g}from"./frequenciesStore-OBxwI2Ci.js";import{u as M}from"./transactionsStore-C75SVRH7.js";import{I as k}from"./InputField-ChZeaM8-.js";import{M as F}from"./Modal-Cq0Vn9TI.js";import{S as E}from"./Select-DISv0Wvs.js";import{I as T,r as v}from"./IconBase.esm-BHyQ0JS4.js";var l=new Map;l.set("bold",function(e){return t.createElement(t.Fragment,null,t.createElement("line",{x1:"44",y1:"156",x2:"100",y2:"212",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),t.createElement("line",{x1:"164",y1:"92",x2:"72",y2:"184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});l.set("duotone",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M192,120,136,64l26.3-26.3a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4Z",opacity:"0.2"}),t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});l.set("fill",function(){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M224,76.7,179.3,32a15.9,15.9,0,0,0-22.6,0L130.3,58.3h0L36.7,152A15.9,15.9,0,0,0,32,163.3V208a16,16,0,0,0,16,16H92.7a15.9,15.9,0,0,0,11.3-4.7l120-120A16.1,16.1,0,0,0,224,76.7ZM51.3,160,144,67.3,160.7,84,68,176.7ZM48,179.3,76.7,208H48Zm48,25.4L79.3,188,172,95.3,188.7,112Z"}))});l.set("light",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});l.set("thin",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});l.set("regular",function(e){return t.createElement(t.Fragment,null,t.createElement("path",{d:"M92.7,216H48a8,8,0,0,1-8-8V163.3a7.9,7.9,0,0,1,2.3-5.6l120-120a8,8,0,0,1,11.4,0l44.6,44.6a8,8,0,0,1,0,11.4l-120,120A7.9,7.9,0,0,1,92.7,216Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"136",y1:"64",x2:"192",y2:"120",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"164",y1:"92",x2:"68",y2:"188",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),t.createElement("line",{x1:"95.5",y1:"215.5",x2:"40.5",y2:"160.5",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var Z=function(c,m){return v(c,m,l)},j=h.forwardRef(function(e,c){return t.createElement(T,Object.assign({ref:c},e,{renderPath:Z}))});j.displayName="Pencil";const w=C({label:d().min(1,"Le label est requis"),amount:d().min(1,"Le montant est requis").refine(e=>!isNaN(Number(e)),"Le montant doit être un nombre"),dueAt:d().min(1,"La date est requise"),categoryId:d().min(1,"Veuillez sélectionner une catégorie"),frequencyId:d().min(1,"Veuillez sélectionner une fréquence")}),P=w.extend({pointedAt:d().min(2,"La date est requise")}),V=({transaction:e})=>{const c=L.use.categoriesOptions(),m=L.use.fetchCategories(),A=g.use.frequenciesOptions(),y=g.use.fetchFrequencies(),b=M.use.updateCurrentTransaction(),[r,q]=h.useState({label:e.label,amount:e.amount.toString(),dueAt:new Date(e.dueAt).toISOString().slice(0,10),categoryId:e.category.id,pointedAt:e.pointedAt?new Date(e.pointedAt).toISOString().slice(0,10):"",frequencyId:e.frequencyId}),[n,p]=h.useState({}),u=a=>f=>{q(i=>({...i,[a]:f})),n[a]&&p(i=>{const s={...i};return delete s[a],s})};h.useEffect(()=>{m(),y()},[m,y]);const I=()=>{p({})},W=async()=>{const a=P.safeParse(r);if(!a.success){const i={};return a.error.issues.forEach(s=>{s.path[0]&&(i[s.path[0]]=s.message)}),p(i),!1}const f={...r,amount:Number(r.amount),dueAt:new Date(r.dueAt).toISOString(),pointedAt:new Date(r.pointedAt).toISOString()};try{return await b(e.id,f),!0}catch(i){const s=i;for(const x of s.errors)p(S=>({...S,[x.property]:x.message}));return!1}};return o.jsx(F,{title:"Éditer une transaction",cancelLabel:"Annuler",actionLabel:o.jsxs(o.Fragment,{children:[o.jsx(j,{size:16})," Edit"]}),style:"ghost",onConfirm:W,onCancel:I,children:o.jsxs("form",{className:"flex flex-col gap-4",children:[o.jsx(k,{label:"Label",name:"label",id:"transaction_label",value:r.label,placeholder:"Label",onChange:u("label"),style:n.label?"error":"neutral",helperText:n.label}),o.jsx(k,{label:"Montant",name:"amount",id:"transaction_amount",value:r.amount,type:"number",placeholder:"Montant",onChange:u("amount"),style:n.amount?"error":"neutral",helperText:n.amount}),o.jsx(k,{label:"Due le",name:"dueAt",id:"transaction_dueAt",value:r.dueAt,type:"date",placeholder:"Due le",onChange:u("dueAt"),style:n.dueAt?"error":"neutral",helperText:n.dueAt}),o.jsx(k,{label:"Pointé le",name:"pointedAt",id:"transaction_pointedAt",value:r.pointedAt,type:"date",placeholder:"Pointé le",onChange:u("pointedAt"),style:n.pointedAt?"error":"neutral",helperText:n.pointedAt}),o.jsx(E,{id:"transaction_category",name:"category",label:"Categorie",options:c,placeholder:"Choisir une categorie",style:n.categoryId?"error":"neutral",value:r.categoryId,onChange:a=>u("categoryId")(a.target.value),helperText:n.categoryId}),o.jsx(E,{id:"transaction_frequency",name:"frequency",label:"Fréquence",options:A,placeholder:"Choisir une fréquence",style:n.frequencyId?"error":"neutral",value:r.frequencyId,onChange:a=>u("frequencyId")(a.target.value),helperText:n.frequencyId})]})})};V.__docgenInfo={description:"",methods:[],displayName:"TransactionEditModal",props:{transaction:{required:!0,tsType:{name:"Transaction"},description:""}}};export{V as T};
