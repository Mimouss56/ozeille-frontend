import{r as m,j as n}from"./iframe-B4Jk3YgJ.js";import{u as C,a as A,o as v,s as u}from"./frequenciesStore-bwcQSpn-.js";import{u as S}from"./transactionsStore-B2J_gN5w.js";import{I as d}from"./InputField-C-SHq8YP.js";import{M as T}from"./Modal-COvFmOT0.js";import{S as h}from"./Select-DF7VlINy.js";const j=v({label:u().min(1,"Le label est requis"),amount:u().min(1,"Le montant est requis").refine(c=>!isNaN(Number(c)),"Le montant doit être un nombre"),dueAt:u().min(1,"La date est requise"),categoryId:u().min(1,"Veuillez sélectionner une catégorie"),frequencyId:u().min(1,"Veuillez sélectionner une fréquence")}),L=()=>{const{fetchCategories:c,categoriesOptions:y}=C(),{fetchFrequencies:f,frequenciesOptions:b}=A(),{createNewTransaction:q}=S(),[r,p]=m.useState({label:"",amount:"",dueAt:"",categoryId:"",frequencyId:""}),[e,i]=m.useState({}),s=t=>o=>{p(a=>({...a,[t]:o})),e[t]&&i(a=>{const l={...a};return delete l[t],l})},g=()=>{p({label:"",amount:"",dueAt:"",categoryId:"",frequencyId:""}),i({})};m.useEffect(()=>{c(),f()},[c,f]);const x=async()=>{const t=j.safeParse(r);if(!t.success){const o={};return t.error.issues.forEach(a=>{a.path[0]&&(o[a.path[0]]=a.message)}),i(o),!1}try{return await q({...r,amount:Number(r.amount),dueAt:new Date(r.dueAt).toISOString()}),g(),!0}catch(o){const a=o;for(const l of a.errors)i(I=>({...I,[l.property]:l.message}));return!1}};return n.jsx(T,{title:"Créer une nouvelle transaction",cancelLabel:"Annuler",actionLabel:"Créer une nouvelle transaction",onCancel:g,onConfirm:x,children:n.jsxs("form",{className:"flex flex-col gap-4",children:[n.jsx(d,{label:"Label",name:"label",id:"transaction_label",value:r.label,placeholder:"Label",onChange:s("label"),style:e.label?"error":"neutral",helperText:e.label}),n.jsx(d,{label:"Montant",name:"amount",id:"transaction_amount",value:r.amount,type:"number",placeholder:"Montant",onChange:s("amount"),style:e.amount?"error":"neutral",helperText:e.amount}),n.jsx(d,{label:"Due le",name:"dueAt",id:"transaction_dueAt",value:r.dueAt,type:"date",placeholder:"Due le",onChange:s("dueAt"),style:e.dueAt?"error":"neutral",helperText:e.dueAt}),n.jsx(h,{id:"transaction_category",name:"category",label:"Categorie",options:y,placeholder:"Choisir une categorie",style:e.categoryId?"error":"neutral",value:r.categoryId,onChange:t=>s("categoryId")(t.target.value),helperText:e.categoryId}),n.jsx(h,{id:"transaction_frequency",name:"frequency",label:"Fréquence",options:b,placeholder:"Choisir une fréquence",style:e.frequencyId?"error":"neutral",value:r.frequencyId,onChange:t=>s("frequencyId")(t.target.value),helperText:e.frequencyId})]})})};L.__docgenInfo={description:"",methods:[],displayName:"TransactionModal"};export{L as T};
