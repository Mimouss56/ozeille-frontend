import{r as m,j as n}from"./iframe-CRKZNwbZ.js";import{u as y,a as b,o as v,s as u}from"./frequenciesStore-Cz0NWIPk.js";import{u as T}from"./transactionsStore-DPkBKJhl.js";import{I as d}from"./InputField-CtuniQtT.js";import{M as j}from"./Modal-DnflQd3D.js";import{S as q}from"./Select-DZC8V8_T.js";const S=v({label:u().min(1,"Le label est requis"),amount:u().min(1,"Le montant est requis").refine(i=>!isNaN(Number(i)),"Le montant doit être un nombre"),dueAt:u().min(1,"La date est requise"),categoryId:u().min(1,"Veuillez sélectionner une catégorie"),frequencyId:u().min(1,"Veuillez sélectionner une fréquence")}),L=()=>{const i=y.use.categoriesOptions(),f=y.use.fetchCategories(),x=b.use.frequenciesOptions(),p=b.use.fetchFrequencies(),I=T.use.createNewTransaction(),[r,h]=m.useState({label:"",amount:"",dueAt:"",categoryId:"",frequencyId:""}),[e,c]=m.useState({}),s=t=>o=>{h(a=>({...a,[t]:o})),e[t]&&c(a=>{const l={...a};return delete l[t],l})},g=()=>{h({label:"",amount:"",dueAt:"",categoryId:"",frequencyId:""}),c({})};m.useEffect(()=>{f(),p()},[f,p]);const C=async()=>{const t=S.safeParse(r);if(!t.success){const o={};return t.error.issues.forEach(a=>{a.path[0]&&(o[a.path[0]]=a.message)}),c(o),!1}try{return await I({...r,amount:Number(r.amount),dueAt:new Date(r.dueAt).toISOString()}),g(),!0}catch(o){const a=o;for(const l of a.errors)c(A=>({...A,[l.property]:l.message}));return!1}};return n.jsx(j,{title:"Créer une nouvelle transaction",cancelLabel:"Annuler",actionLabel:"Créer une nouvelle transaction",onCancel:g,onConfirm:C,children:n.jsxs("form",{className:"flex flex-col gap-4",children:[n.jsx(d,{label:"Label",name:"label",id:"transaction_label",value:r.label,placeholder:"Label",onChange:s("label"),style:e.label?"error":"neutral",helperText:e.label}),n.jsx(d,{label:"Montant",name:"amount",id:"transaction_amount",value:r.amount,type:"number",placeholder:"Montant",onChange:s("amount"),style:e.amount?"error":"neutral",helperText:e.amount}),n.jsx(d,{label:"Due le",name:"dueAt",id:"transaction_dueAt",value:r.dueAt,type:"date",placeholder:"Due le",onChange:s("dueAt"),style:e.dueAt?"error":"neutral",helperText:e.dueAt}),n.jsx(q,{id:"transaction_category",name:"category",label:"Categorie",options:i,placeholder:"Choisir une categorie",style:e.categoryId?"error":"neutral",value:r.categoryId,onChange:t=>s("categoryId")(t.target.value),helperText:e.categoryId}),n.jsx(q,{id:"transaction_frequency",name:"frequency",label:"Fréquence",options:x,placeholder:"Choisir une fréquence",style:e.frequencyId?"error":"neutral",value:r.frequencyId,onChange:t=>s("frequencyId")(t.target.value),helperText:e.frequencyId})]})})};L.__docgenInfo={description:"",methods:[],displayName:"TransactionModal"};export{L as T};
